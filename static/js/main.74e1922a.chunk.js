(window["webpackJsonphips-web"]=window["webpackJsonphips-web"]||[]).push([[0],{101:function(e,t,n){},102:function(e,t,n){},107:function(e,t){},109:function(e,t){},145:function(e,t){},146:function(e,t){},208:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(54),i=n.n(o),s=(n(101),n(13)),c=n(14),l=n(16),u=n(15),d=n(17),h=(n(102),n(103),n(94)),m=n.n(h);function p(e){var t=JSON.parse(window.localStorage.hips);return function(e,t){var n=Uint8Array.from(e,(function(e){return e.charCodeAt(0)})),a=Uint8Array.from(atob(t),(function(e){return e.charCodeAt(0)}));return window.crypto.subtle.importKey("raw",n,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]).then((function(e){return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:1e4,hash:{name:"SHA-256"}},e,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"])}))}(e,t.salt).then((function(e){var n=Uint8Array.from(atob(t.iv),(function(e){return e.charCodeAt(0)})),a=Uint8Array.from(atob(t.keys),(function(e){return e.charCodeAt(0)}));return window.crypto.subtle.decrypt({name:"AES-CBC",iv:n},e,a)})).then((function(e){var t=(new TextDecoder).decode(e),n=JSON.parse(t);return function(e){if(!e.privateKey||!e.publicKey)throw new Error("Invalid decrypted data")}(n),n}))}function f(e,t){var n;return p(e).then((function(e){return n=e.privateKey,function(e){return function(e){if(window.localStorage.gistId)return Promise.resolve(window.localStorage.gistId);return fetch("https://api.github.com/users/".concat(e,"/gists")).then((function(e){return e.json()})).then((function(e){return e.find((function(e){return e.description.match(/^hips.storage$/)}))})).then((function(e){return window.localStorage.gistId=e.id,e.id}))}(e).then(w).then((function(e){return e.files.hips_passwords.content}))}(t)})).then((function(e){return function(e,t){var n=new m.a;n.importKey(e);var a=(new TextDecoder).decode(n.decrypt(t));return JSON.parse(a)}(n,e)}))}function w(e){return fetch("https://api.github.com/gists/".concat(e)).then((function(e){return e.json()}))}var y=function(e){function t(){var e;Object(s.a)(this,t),e=Object(l.a)(this,Object(u.a)(t).call(this));var n=new URLSearchParams(window.location.search);return e.state={gistId:n.get("gistId"),error:null},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;w(this.state.gistId).then((function(t){window.localStorage.username=t.owner.login,window.localStorage.hips=t.files.hips_data.content,e.props.callback()})).catch((function(t){console.log(t),e.setState({error:t.stack})}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"importer"},r.a.createElement("h1",{className:"title is-3"},"We are importing your data"),r.a.createElement("p",null,"Please wait"),this.state.error&&r.a.createElement("p",null,this.state.error))}}]),t}(r.a.Component),b=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).handleInput=function(t){e.setState({masterKey:t.target.value})},e.unlock=function(){p(e.state.masterKey).then((function(t){e.props.onFinish(e.state.masterKey)})).catch((function(e){console.log(e)}))},e.state={masterKey:"",test:""},e.crypto=JSON.parse(window.localStorage.hips),e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"masterkey"},r.a.createElement("h1",{className:"title is-3"},"Enter Master Key"),r.a.createElement("input",{type:"password",value:this.state.masterKey,onChange:this.handleInput,className:"input is-primary"}),r.a.createElement("button",{className:"button is-primary is-large masterkey-button",onClick:this.unlock},"Unlock"),r.a.createElement("p",null,this.state.test))}}]),t}(r.a.Component),v=n(95),g=n.n(v),S=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).select=function(t){return function(){e.setState({selected:t.password})}},e.onSelect=function(e){return function(){alert("password ".concat(e.name," copied to the clipboard"))}},e.reset=function(){delete window.localStorage.hips,delete window.localStorage.gistId,delete window.localStorage.credentials,window.location.reload()},e.state={passwords:[],selected:""},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=window.localStorage.username;f(this.props.masterKey,t).then((function(t){e.setState({passwords:t.passwords})}))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"home"},r.a.createElement("h1",{className:"title is-3 home-title"},"Stored Passwords"),r.a.createElement("div",{className:"home-passwords"},this.state.passwords.map((function(t){return r.a.createElement(g.a,{key:t.key,className:"button home-button is-primary","data-clipboard-text":t.password,onSuccess:e.onSelect(t)},t.name)})))),r.a.createElement("div",{className:"reset-wrapper"},r.a.createElement("button",{className:"button home-reset is-danger is-fullwidth",onClick:this.reset},"reset")))}}]),t}(r.a.Component);var k=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).masterKeyCallback=function(t){e.setState({masterKey:t})},e.importCallback=function(){e.setState({hasImportedData:!0})},e.state={hasImportedData:!!window.localStorage.hips,masterKey:""},e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app"},this.renderPage())}},{key:"renderPage",value:function(){return this.state.hasImportedData?this.state.masterKey?r.a.createElement(S,{masterKey:this.state.masterKey}):r.a.createElement(b,{onFinish:this.masterKeyCallback}):r.a.createElement(y,{callback:this.importCallback})}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},96:function(e,t,n){e.exports=n(208)}},[[96,1,2]]]);
//# sourceMappingURL=main.74e1922a.chunk.js.map