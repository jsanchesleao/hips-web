(window["webpackJsonphips-web"]=window["webpackJsonphips-web"]||[]).push([[0],{101:function(t,e,n){},102:function(t,e,n){},107:function(t,e){},109:function(t,e){},145:function(t,e){},146:function(t,e){},208:function(t,e,n){},209:function(t,e,n){"use strict";n.r(e);var a=n(2),r=n.n(a),o=n(54),i=n.n(o),s=(n(101),n(13)),c=n(14),u=n(16),l=n(15),m=n(17),h=(n(102),n(103),n(94)),d=n.n(h);function p(t){var e=JSON.parse(window.localStorage.hips);return function(t,e){var n=Uint8Array.from(t,(function(t){return t.charCodeAt(0)})),a=Uint8Array.from(atob(e),(function(t){return t.charCodeAt(0)}));return window.crypto.subtle.importKey("raw",n,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]).then((function(t){return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:1e4,hash:{name:"SHA-256"}},t,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"])}))}(t,e.salt).then((function(t){var n=Uint8Array.from(atob(e.iv),(function(t){return t.charCodeAt(0)})),a=Uint8Array.from(atob(e.keys),(function(t){return t.charCodeAt(0)}));return window.crypto.subtle.decrypt({name:"AES-CBC",iv:n},t,a)})).then((function(t){var e=(new TextDecoder).decode(t),n=JSON.parse(e);return function(t){if(!t.privateKey||!t.publicKey)throw new Error("Invalid decrypted data")}(n),n}))}function f(t,e){var n;return p(t).then((function(t){return n=t.privateKey,function(t){return function(t){if(window.localStorage.gistId)return Promise.resolve(window.localStorage.gistId);return fetch("https://api.github.com/users/".concat(t,"/gists")).then((function(t){return t.json()})).then((function(t){return t.find((function(t){return t.description.match(/^hips.storage$/)}))})).then((function(t){return window.localStorage.gistId=t.id,t.id}))}(t).then(w).then((function(t){return t.files.hips_passwords.content}))}(e)})).then((function(t){return function(t,e){var n=new d.a;n.importKey(t);var a=(new TextDecoder).decode(n.decrypt(e));return JSON.parse(a)}(n,t)}))}function w(t){return fetch("https://api.github.com/gists/".concat(t)).then((function(t){return t.json()}))}var y=function(t){function e(){var t;return Object(s.a)(this,e),(t=Object(u.a)(this,Object(l.a)(e).call(this))).handleInput=function(e){t.setState({gistId:e.target.value})},t.handleSubmit=function(){t.doImport(t.state.gistId)},t.state={importStarted:!1,error:null},t}return Object(m.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=new URLSearchParams(window.location.search).get("gistId");t&&this.doImport(t)}},{key:"doImport",value:function(t){var e=this;this.setState({importStarted:!0}),w(t).then((function(t){window.localStorage.username=t.owner.login,window.localStorage.hips=t.files.hips_data.content,e.props.callback()})).catch((function(t){console.log(t),e.setState({error:t.stack})}))}},{key:"renderInputScreen",value:function(){return r.a.createElement("div",{className:"importer"},r.a.createElement("h1",{className:"title is-3"},"Enter ID from CLI:"),r.a.createElement("input",{type:"text",value:this.state.gistId,onChange:this.handleInput,className:"input is-primary"}),r.a.createElement("button",{className:"button is-primary is-large importer-button",onClick:this.handleSubmit},"Import"))}},{key:"renderWaitingScreen",value:function(){return r.a.createElement("div",{className:"importer"},r.a.createElement("h1",{className:"title is-3"},"We are importing your data"),r.a.createElement("p",null,"Please wait"),this.state.error&&r.a.createElement("p",null,this.state.error))}},{key:"render",value:function(){return this.state.importStarted?this.renderWaitingScreen():this.renderInputScreen()}}]),e}(r.a.Component),b=function(t){function e(){var t;return Object(s.a)(this,e),(t=Object(u.a)(this,Object(l.a)(e).call(this))).handleInput=function(e){t.setState({masterKey:e.target.value})},t.unlock=function(){p(t.state.masterKey).then((function(e){t.props.onFinish(t.state.masterKey)})).catch((function(t){console.log(t)}))},t.state={masterKey:"",test:""},t.crypto=JSON.parse(window.localStorage.hips),t}return Object(m.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"masterkey"},r.a.createElement("h1",{className:"title is-3"},"Enter Master Key"),r.a.createElement("input",{type:"password",value:this.state.masterKey,onChange:this.handleInput,className:"input is-primary"}),r.a.createElement("button",{className:"button is-primary is-large masterkey-button",onClick:this.unlock},"Unlock"))}}]),e}(r.a.Component),v=n(95),g=n.n(v),k=(n(208),function(t){function e(){var t;return Object(s.a)(this,e),(t=Object(u.a)(this,Object(l.a)(e).call(this))).select=function(e){return function(){t.setState({selected:e.password})}},t.onSelect=function(t){return function(){alert("password ".concat(t.name," copied to the clipboard"))}},t.lock=function(){t.props.onLock()},t.state={passwords:[],selected:""},t}return Object(m.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=window.localStorage.username;f(this.props.masterKey,e).then((function(e){t.setState({passwords:e.passwords})}))}},{key:"render",value:function(){var t=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"home"},r.a.createElement("h1",{className:"title is-3 home-title"},"Stored Passwords"),r.a.createElement("div",{className:"home-passwords"},this.state.passwords.map((function(e){return r.a.createElement(g.a,{key:e.key,className:"button home-button is-primary","data-clipboard-text":e.password,onSuccess:t.onSelect(e)},e.name)})))),r.a.createElement("div",{className:"reset-wrapper"},r.a.createElement("button",{className:"button home-reset is-danger is-fullwidth",onClick:this.lock},"Lock")))}}]),e}(r.a.Component));var S=function(t){function e(){var t;return Object(s.a)(this,e),(t=Object(u.a)(this,Object(l.a)(e).call(this))).masterKeyCallback=function(e){t.setState({masterKey:e})},t.lock=function(){t.setState({masterKey:""})},t.importCallback=function(){t.setState({hasImportedData:!0})},t.state={hasImportedData:!!window.localStorage.hips,masterKey:""},t}return Object(m.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"app"},this.renderPage())}},{key:"renderPage",value:function(){return this.state.hasImportedData?this.state.masterKey?r.a.createElement(k,{masterKey:this.state.masterKey,onLock:this.lock}):r.a.createElement(b,{onFinish:this.masterKeyCallback}):r.a.createElement(y,{callback:this.importCallback})}}]),e}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},96:function(t,e,n){t.exports=n(209)}},[[96,1,2]]]);
//# sourceMappingURL=main.982e4d90.chunk.js.map